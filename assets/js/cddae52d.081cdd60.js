"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3199],{80722:(A,e,g)=>{g.r(e),g.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>r,frontMatter:()=>a,metadata:()=>o,toc:()=>B});var t=g(13274),n=g(79779);const a={slug:"java-out-pdf",title:"Java\u8f93\u51faPDF",date:new Date("2024-01-20T00:00:00.000Z"),authors:"yuchengee",tags:["java","pdf","\u6587\u4ef6","itextpdf"]},i=void 0,o={permalink:"/blog/java-out-pdf",editUrl:"https://github.com/yuchengee/blog/edit/master/blog/2024/01-20-Java\u8f93\u51faPDF.md",source:"@site/blog/2024/01-20-Java\u8f93\u51faPDF.md",title:"Java\u8f93\u51faPDF",description:"\u9879\u76ee\u4e2d\u9047\u5230\u9700\u8981\u5bfc\u51faPDF\u7684\u9700\u6c42\uff0c\u8bb0\u5f55\u4f7f\u7528 itextpdf \u5bfc\u51fapdf\u3002",date:"2024-01-20T00:00:00.000Z",formattedDate:"2024\u5e741\u670820\u65e5",tags:[{label:"java",permalink:"/blog/tags/java"},{label:"pdf",permalink:"/blog/tags/pdf"},{label:"\u6587\u4ef6",permalink:"/blog/tags/\u6587\u4ef6"},{label:"itextpdf",permalink:"/blog/tags/itextpdf"}],readingTime:1.79,hasTruncateMarker:!0,authors:[{name:"yuchengee",title:"\u5e9f\u54c1\u5de5\u7a0b\u5e08",url:"https://github.com/yuchengee",imageURL:"/img/logo.png",key:"yuchengee"}],frontMatter:{slug:"java-out-pdf",title:"Java\u8f93\u51faPDF",date:"2024-01-20T00:00:00.000Z",authors:"yuchengee",tags:["java","pdf","\u6587\u4ef6","itextpdf"]},unlisted:!1,prevItem:{title:"geotools\u4e2d\u7684\u5173\u7cfb\u8868\u8fbe\u5f0f",permalink:"/blog/java-geotools-relep"},nextItem:{title:"\u666e\u901ajava\u9879\u76ee\u6253jar\u5305\u8fd0\u884c\u65b9\u5f0f",permalink:"/blog/java-build-run"}},d={authorsImageUrls:[void 0]},B=[{value:"\u521b\u5efa\u6a21\u677f",id:"\u521b\u5efa\u6a21\u677f",level:3},{value:"\u4ee3\u7801\u586b\u5145",id:"\u4ee3\u7801\u586b\u5145",level:3},{value:"\u8fd0\u884c\u7ed3\u679c",id:"\u8fd0\u884c\u7ed3\u679c",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:3}];function D(A){const e={code:"code",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,n.R)(),...A.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:"\u9879\u76ee\u4e2d\u9047\u5230\u9700\u8981\u5bfc\u51faPDF\u7684\u9700\u6c42\uff0c\u8bb0\u5f55\u4f7f\u7528 itextpdf \u5bfc\u51fapdf\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5de5\u4f5c\u4e2d\u7ecf\u5e38\u9047\u5230\u9700\u8981\u5c06\u6570\u636e\u5bfc\u51fa\u6587\u4ef6\u7684\u9700\u6c42\uff0c\u4e00\u822c\u5bfc\u51facsv\u8fd9\u79cd\u6bd4\u8f83\u7b80\u5355\u3002\u8fd9\u6b21\u9047\u5230\u9700\u8981\u5bfc\u51fa\u6210PDF\uff0c\u8fd9\u5c31\u6bd4\u8f83\u9ebb\u70e6\u4e86\uff0c\u4f7f\u7528 itextpdf \u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u9700\u6c42\u3002"}),"\n",(0,t.jsx)(e.p,{children:"itextpdf\u53ef\u4ee5\u76f4\u63a5\u8f93\u51faPDF\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167PDF\u6a21\u677f\u586b\u5145\u5b57\u6bb5\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u521b\u5efa\u6a21\u677f",children:"\u521b\u5efa\u6a21\u677f"}),"\n",(0,t.jsx)(e.p,{children:"\u521b\u5efaPDF\u6a21\u677f\uff0c\u9700\u8981\u4f7f\u7528 Adobe Acrobat DC\uff0c\u8be5\u8f6f\u4ef6\u53ef\u4ee5\u81ea\u884c\u767e\u5ea6\u5b89\u88c5\u5373\u53ef\u3002"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5728word\u4e2d\u753b\u597d\u6a21\u677f\uff0c\u53e6\u5b58\u4e3aPDF\u683c\u5f0f\u3002\n",(0,t.jsx)(e.img,{alt:"word\u683c\u5f0f",src:g(31518).A+"",width:"816",height:"441"})]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u6253\u5f00 Adobe Acrobat DC\uff0c\u9009\u62e9\u5de5\u5177-\u51c6\u5907\u8868\u5355\uff0c\u9009\u62e9\u521a\u521a\u5bfc\u51fa\u7684PDF\u3002\n",(0,t.jsx)(e.img,{alt:"Adobe",src:g(52762).A+"",width:"1077",height:"679"})]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u7f16\u8f91\u8868\u5355\u5b57\u6bb5\u3002\u4fdd\u5b58\u4e3a\u6a21\u677f\u3002\n",(0,t.jsx)(e.img,{alt:"Adobe",src:g(48955).A+"",width:"1322",height:"685"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\u4ee3\u7801\u586b\u5145",children:"\u4ee3\u7801\u586b\u5145"}),"\n",(0,t.jsx)(e.p,{children:"maven\u4f9d\u8d56"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"<dependencies>\n    \x3c!-- PDF\u5de5\u5177\u7c7b --\x3e\n    <dependency>\n        <groupId>com.itextpdf</groupId>\n        <artifactId>itextpdf</artifactId>\n        <version>5.5.13</version>\n    </dependency>\n    \x3c!-- PDF\u4e2d\u6587\u652f\u6301 --\x3e\n    <dependency>\n        <groupId>com.itextpdf</groupId>\n        <artifactId>itext-asian</artifactId>\n        <version>5.2.0</version>\n    </dependency>\n</dependencies>\n"})}),"\n",(0,t.jsx)(e.p,{children:"java\u586b\u5145"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public static void main(String[] args) throws Exception {\n    String name = "\u5927\u806a\u660e";\n    String date = "2024-01-20";\n    String imagePath = "D:\\\\test.PNG";\n    outPdf(name, date, imagePath);\n}\n\npublic static void outPdf(String name, String date, String imagePath) throws Exception {\n    String templatePath = "d:\\\\test1.pdf";\n    String outPdf = "d:\\\\out.pdf";\n\n    BaseFont bfChinese = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);\n\n    try (FileOutputStream out = new FileOutputStream(outPdf);\n            ByteArrayOutputStream bos = new ByteArrayOutputStream()){\n        PdfReader reader = new PdfReader(templatePath);\n        PdfStamper stamper = new PdfStamper(reader, bos);\n        AcroFields form = stamper.getAcroFields();\n        form.addSubstitutionFont(bfChinese);\n        form.setField("name", name);\n        form.setField("date", date);\n\n        //\u56fe\u7247\u7c7b\u7684\u5185\u5bb9\u5904\u7406\n        String imagekey = "image";\n        int pageNo = form.getFieldPositions(imagekey).get(0).page;\n        Rectangle signRect = form.getFieldPositions(imagekey).get(0).position;\n        float x = signRect.getLeft();\n        float y = signRect.getBottom();\n        //\u6839\u636e\u8def\u5f84\u8bfb\u53d6\u56fe\u7247\n        Image image = Image.getInstance(imagePath);\n        //\u83b7\u53d6\u56fe\u7247\u9875\u9762\n        PdfContentByte under = stamper.getOverContent(pageNo);\n        //\u56fe\u7247\u5927\u5c0f\u81ea\u9002\u5e94\n        image.scaleToFit(signRect.getWidth(), signRect.getHeight());\n        //\u6dfb\u52a0\u56fe\u7247\n        image.setAbsolutePosition(x, y);\n        under.addImage(image);\n        // \u5982\u679c\u4e3afalse\uff0c\u751f\u6210\u7684PDF\u6587\u4ef6\u53ef\u4ee5\u7f16\u8f91\uff0c\u5982\u679c\u4e3atrue\uff0c\u751f\u6210\u7684PDF\u6587\u4ef6\u4e0d\u53ef\u4ee5\u7f16\u8f91\n        stamper.setFormFlattening(true);\n        stamper.close();\n\n        Document doc = new Document();\n        PdfCopy copy = new PdfCopy(doc, out);\n        doc.open();\n        PdfImportedPage importPage = copy.getImportedPage(new PdfReader(bos.toByteArray()), 1);\n        copy.addPage(importPage);\n        doc.close();\n    }\n\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8fd0\u884c\u7ed3\u679c",children:"\u8fd0\u884c\u7ed3\u679c"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"out",src:g(61892).A+"",width:"803",height:"480"})}),"\n",(0,t.jsx)(e.h3,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,t.jsx)(e.p,{children:"\u4ece\u4e0a\u9762\u7684\u8fc7\u7a0b\u6765\u770b\uff0c\u8fd8\u662f\u5f88\u7b80\u5355\u7684\u3002\u867d\u7136\u53ea\u67093\u4e2a\u586b\u5145\uff0c\u4f46\u662f\u5df2\u7ecf\u6253\u901a\u4e86Java\u5bfc\u51faPDF\u7684\u6d41\u7a0b\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u80af\u5b9a\u4e0d\u6b62\u8fd9\u51e0\u4e2a\u7b80\u5355\u5b57\u6bb5\uff0c\u4f46\u662f\u53ea\u8981\u77e5\u9053\u4e86\u57fa\u672c\u64cd\u4f5c\uff0c\u4e0d\u7ba1\u6a21\u677f\u591a\u590d\u6742\uff0c\u586b\u5145\u4e0d\u540c\u7c7b\u578b\u7684\u5b57\u6bb5\u4ee3\u7801\u4e5f\u53ef\u4ee5\u53c2\u8003\uff0c\u4e5f\u5c31\u53ef\u4ee5\u5bfc\u51fa\u4efb\u610f\u8981\u6c42\u7684PDF\u3002"})]})}function r(A={}){const{wrapper:e}={...(0,n.R)(),...A.components};return e?(0,t.jsx)(e,{...A,children:(0,t.jsx)(D,{...A})}):D(A)}},48955:(A,e,g)=>{g.d(e,{A:()=>t});const t=g.p+"assets/images/0120-form-field-d61164010a4ad29235cacef23c3b6c71.png"},61892:(A,e,g)=>{g.d(e,{A:()=>t});const t=g.p+"assets/images/0120-out-7cfbfee9baa126586f2106f29d31c447.png"},52762:(A,e,g)=>{g.d(e,{A:()=>t});const t=g.p+"assets/images/0120-pform-a47d342664bad974b0030e62ed268fa6.png"},31518:(A,e,g)=>{g.d(e,{A:()=>t});const t="data:image/png;base64,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"},79779:(A,e,g)=>{g.d(e,{R:()=>i,x:()=>o});var t=g(79474);const n={},a=t.createContext(n);function i(A){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof A?A(e):{...e,...A}}),[e,A])}function o(A){let e;return e=A.disableParentContext?"function"==typeof A.components?A.components(n):A.components||n:i(A.components),t.createElement(a.Provider,{value:e},A.children)}}}]);